---
- name: Playbook de Testes
  become: true
  become_method: sudo
  gather_facts: false
  hosts: "{{ host }}"
  roles:
    - role: "check_package_installed"

  tasks:
    - name: Gather the package facts
      ansible.builtin.package_facts:
        manager: auto

    - name: Print the package facts
      ansible.builtin.debug:
        var: ansible_facts.packages

    - name: Check whether a package called {{ app }} is installed
      ansible.builtin.debug:
        # msg: "{{ ansible_facts.packages['{{ app }}'] | length }} versions of {{ app }} are installed!"
        msg: "AAAAAAAAAA"
      when: '"{{ app }}" in ansible_facts.packages'
    
  #   - name: Check whether a package called {{ app2 }} is installed
  #     ansible.builtin.debug:
  #       # msg: "{{ ansible_facts.packages['{{ app }}'] | length }} versions of {{ app }} are installed!"
  #       msg: "BBBBBBBBBB"
  #     when: '"{{ app2 }}" in ansible_facts.packages'

  #   - name: Package status
  #     debug:
  #       msg: "{{ item }} {{ 'installed' if item in ansible_facts.packages else 'not installed' }}"
  #     loop: "{{ pkgs | default([]) }}"